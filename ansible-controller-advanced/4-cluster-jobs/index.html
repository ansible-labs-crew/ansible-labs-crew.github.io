<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.69.0" />
    <meta name="description" content="Ansible and Ansible Automation Platform Labs">
<meta name="author" content="Christian, Eric, Götz">

    <link rel="icon" href="https://ansible-labs-crew.github.io/images/favicon.png" type="image/png">

    <title>Primer on Execution Environments: Running Jobs in a Cluster :: Ansible Labs for Red Hat Summit 2021</title>

    
    <link href="https://ansible-labs-crew.github.io/css/nucleus.css?1632505063" rel="stylesheet">
    <link href="https://ansible-labs-crew.github.io/css/fontawesome-all.min.css?1632505063" rel="stylesheet">
    <link href="https://ansible-labs-crew.github.io/css/hybrid.css?1632505063" rel="stylesheet">
    <link href="https://ansible-labs-crew.github.io/css/featherlight.min.css?1632505063" rel="stylesheet">
    <link href="https://ansible-labs-crew.github.io/css/perfect-scrollbar.min.css?1632505063" rel="stylesheet">
    <link href="https://ansible-labs-crew.github.io/css/auto-complete.css?1632505063" rel="stylesheet">
    <link href="https://ansible-labs-crew.github.io/css/atom-one-dark-reasonable.css?1632505063" rel="stylesheet">
    <link href="https://ansible-labs-crew.github.io/css/theme.css?1632505063" rel="stylesheet">
    <link href="https://ansible-labs-crew.github.io/css/tabs.css?1632505063" rel="stylesheet">
    <link href="https://ansible-labs-crew.github.io/css/hugo-theme.css?1632505063" rel="stylesheet">
    
    <link href="https://ansible-labs-crew.github.io/css/theme-red.css?1632505063" rel="stylesheet">
    
    

    <script src="https://ansible-labs-crew.github.io/js/jquery-3.3.1.min.js?1632505063"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    
  </head>
  <body class="" data-url="/ansible-controller-advanced/4-cluster-jobs/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="https://ansible-labs-crew.github.io/">
  <img src="https://ansible-labs-crew.github.io/images/summit-2021.png">
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="https://ansible-labs-crew.github.io/js/lunr.min.js?1632505063"></script>
<script type="text/javascript" src="https://ansible-labs-crew.github.io/js/auto-complete.js?1632505063"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/ansible-labs-crew.github.io\/";
    
</script>
<script type="text/javascript" src="https://ansible-labs-crew.github.io/js/search.js?1632505063"></script>

    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='https://ansible-labs-crew.github.io/'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/ansible-getting-started/" title="Ansible Getting Started" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-getting-started/">
          Ansible Getting Started
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/ansible-getting-started/1-setup/" title="Check the Prerequisites" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-getting-started/1-setup/">
          Check the Prerequisites
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ansible-getting-started/2-adhoc/" title="Running ad hoc commands" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-getting-started/2-adhoc/">
          Running ad hoc commands
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ansible-getting-started/3-playbook/" title="Writing Your First Playbook" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-getting-started/3-playbook/">
          Writing Your First Playbook
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ansible-getting-started/4-variables/" title="Using Variables" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-getting-started/4-variables/">
          Using Variables
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ansible-getting-started/5-handlers/" title="Conditionals, Handlers and Loops" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-getting-started/5-handlers/">
          Conditionals, Handlers and Loops
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ansible-getting-started/6-templates/" title="Templates" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-getting-started/6-templates/">
          Templates
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ansible-getting-started/7-bonus/" title="Bonus Labs" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-getting-started/7-bonus/">
          Bonus Labs
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/ansible-controller-getting-started/" title="Ansible automation controller getting started" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-controller-getting-started/">
          Ansible automation controller getting started
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/ansible-controller-getting-started/1-intro/" title="Introduction to automation controller" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-controller-getting-started/1-intro/">
          Introduction to automation controller
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ansible-controller-getting-started/2-cred/" title="Inventories, credentials and ad hoc commands" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-controller-getting-started/2-cred/">
          Inventories, credentials and ad hoc commands
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ansible-controller-getting-started/3-projects/" title="Projects &amp; job templates" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-controller-getting-started/3-projects/">
          Projects &amp; job templates
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ansible-controller-getting-started/4-surveys/" title="Surveys" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-controller-getting-started/4-surveys/">
          Surveys
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ansible-controller-getting-started/5-rbac/" title="Role-based access control" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-controller-getting-started/5-rbac/">
          Role-based access control
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ansible-controller-getting-started/6-workflows/" title="Workflows" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-controller-getting-started/6-workflows/">
          Workflows
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ansible-controller-getting-started/7-wrap/" title="Wrap up" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-controller-getting-started/7-wrap/">
          Wrap up
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/ansible-controller-advanced/" title="Ansible automation controller advanced" class="dd-item
        parent
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-controller-advanced/">
          Ansible automation controller advanced
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/ansible-controller-advanced/1-intro/" title="Introduction to your lab" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-controller-advanced/1-intro/">
          Introduction to your lab
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ansible-controller-advanced/2-clustering/" title="Introduction to automation controller clustering" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-controller-advanced/2-clustering/">
          Introduction to automation controller clustering
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ansible-controller-advanced/3-awx-collection-intro/" title="There is more to automation controller than the Web UI" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-controller-advanced/3-awx-collection-intro/">
          There is more to automation controller than the Web UI
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ansible-controller-advanced/4-cluster-jobs/" title="Primer on Execution Environments: Running Jobs in a Cluster" class="dd-item
        
        active
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-controller-advanced/4-cluster-jobs/">
          Primer on Execution Environments: Running Jobs in a Cluster
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ansible-controller-advanced/5-instance-groups/" title="automation controller instance groups" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-controller-advanced/5-instance-groups/">
          automation controller instance groups
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ansible-controller-advanced/6-parallel-jobs/" title="Parallel Jobs" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-controller-advanced/6-parallel-jobs/">
          Parallel Jobs
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ansible-controller-advanced/7-advanced-inventories/" title="Advanced Inventories" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-controller-advanced/7-advanced-inventories/">
          Advanced Inventories
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ansible-controller-advanced/8-structured-content/" title="Well Structured Content Repositories" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-controller-advanced/8-structured-content/">
          Well Structured Content Repositories
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ansible-controller-advanced/9-rest-api/" title="Discovering the automation controller API" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-controller-advanced/9-rest-api/">
          Discovering the automation controller API
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/ansible-collections/" title="Ansible Collections" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-collections/">
          Ansible Collections
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/ansible-collections/1-introduction/" title="Introduction" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-collections/1-introduction/">
          Introduction
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ansible-collections/2-using-collections-from-playbooks/" title="Collections from Playbook" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-collections/2-using-collections-from-playbooks/">
          Collections from Playbook
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ansible-collections/3-using-collections-from-roles/" title="Collections from Roles" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-collections/3-using-collections-from-roles/">
          Collections from Roles
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ansible-collections/4-using-collections-from-tower/" title="Collections in automation controller" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-collections/4-using-collections-from-tower/">
          Collections in automation controller
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ansible-collections/5-creating-collections/" title="Creating Collections" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-collections/5-creating-collections/">
          Creating Collections
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ansible-collections/6-automation-hub-and-galaxy/" title="Use Automation Hub" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-collections/6-automation-hub-and-galaxy/">
          Use Automation Hub
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/ansible-collections/6-automation-hub-and-galaxy/screenshots/" title="" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/ansible-collections/6-automation-hub-and-galaxy/screenshots/">
          
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vscode-intro/" title="Visual Studio Code - Introduction" class="dd-item
        
        
        
        ">
      <a href="https://ansible-labs-crew.github.io/vscode-intro/">
          Visual Studio Code - Introduction
          
      </a>
      
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://goetzrieger.github.io/"><i class='fas fa-home'></i> Homepage</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p></p>
    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='https://ansible-labs-crew.github.io/'></a> > <a href='https://ansible-labs-crew.github.io/ansible-controller-advanced/'>Ansible automation controller advanced</a> > Primer on Execution Environments: Running Jobs in a Cluster
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#so-which-instance-did-actually-run-the-job">So, which Instance did actually run the Job?</a>
      <ul>
        <li><a href="#from-the-job-output">From the Job Output</a></li>
        <li><a href="#from-the-instance-groups">From the instance groups</a></li>
        <li><a href="#using-the-api">Using the API</a></li>
        <li><a href="#via-api-in-the-browser">Via API in the browser</a></li>
      </ul>
    </li>
    <li><a href="#ansible-execution-environments-primer">Ansible Execution Environments Primer!</a></li>
    <li><a href="#execution-environments-a-deeper-look">Execution Environments: A deeper look</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Primer on Execution Environments: Running Jobs in a Cluster
            </h1>
          

        



	<p>After boot-strapping the controller configuration from bottom up you are ready to start a job in your controller cluster. In one of your controller nodes web UI’s:</p>
<ul>
<li>
<p>Open the <strong>Templates</strong> view</p>
</li>
<li>
<p>Look for the <strong>Install Apache</strong> Template you created with the Playbook</p>
</li>
<li>
<p>Run it by clicking the rocket icon.</p>
</li>
</ul>
<p>At first this is not different from a standard controller setup. But as this is a cluster of active controller instances each instance could have run the job.</p>
<h2 id="so-which-instance-did-actually-run-the-job">So, which Instance did actually run the Job?</h2>
<p>There are a couple of ways to find the node that executed the job.</p>
<h3 id="from-the-job-output">From the Job Output</h3>
<p>The most obvious way is to look up the <strong>Execution Node</strong> in the <strong>Details</strong> tab of the job.
If you closed it already or want to look it up later, go to <strong>Views ⇒ Jobs</strong> and look up the job in question.</p>
<h3 id="from-the-instance-groups">From the instance groups</h3>
<p>In one of the controller instances web UI under <strong>Administration</strong> go to the <strong>Instance Groups</strong> view. For the <code>controlplane</code> instance group, the <strong>Total Jobs</strong> counter shows the number of finished jobs. If you click the <code>controlplane</code> instance group and switch to the <strong>Jobs</strong> tab in the next page, you’ll get a detailed list of jobs.</p>
<p>To see how jobs are distributed over the instances in an <strong>Instance Groups</strong>, go to the <strong>Instances</strong> tab under the <strong>controlplane</strong> group, you will get an overview of the <strong>Total Jobs</strong> each controller instance in this group executed.</p>
<h3 id="using-the-api">Using the API</h3>
<ul>
<li>
<p>First find the job ID: In the web UI access <strong>Views ⇒ Jobs</strong></p>
</li>
<li>
<p>The jobs names are prefixed with the job ID, example <strong>3 - Install Apache</strong></p>
</li>
</ul>

<div class="notices note" ><p>Make sure you choose a job with type &ldquo;Playbook run&rdquo;.</p>
</div>

<ul>
<li>With the ID you can query the API for the instance/node the job was executed on</li>
</ul>
<p>Bring up the terminal in your VSCode session and run:</p>

<div class="notices warning" ><p>Replace <strong>&lt;ID&gt;</strong> with the job ID you want to query and <strong>VERY_SECRET_PASSWORD</strong> with your actual password. And don&rsquo;t forget the proper &lt;GUiD&gt;. Just saying&hellip;</p>
</div>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>lab-user@bastion ~<span style="color:#f92672">]</span>$ curl -s -k -u admin:VERY_SECRET_PASSWORD https://autoctl1.&lt;GUID&gt;.internal/api/v2/jobs/&lt;ID&gt;/ | python3 -m json.tool | grep execution_node

    <span style="color:#e6db74">&#34;execution_node&#34;</span>: <span style="color:#e6db74">&#34;autoctl1.&lt;GUID&gt;.internal&#34;</span>,
</code></pre></div>
<div class="notices tip" ><p>You can use any method you want to access the API and to display the result, of course. The usage of curl and python was just an example.</p>
</div>

<h3 id="via-api-in-the-browser">Via API in the browser</h3>
<p>Another way to query the controller API is using a browser. For example to have a look at the job details (basically what you did above using curl and friends):</p>

<div class="notices tip" ><p>Note you used the internal hostname above, when using your browser, you have to use the external hostname, of course.</p>
</div>

<ul>
<li>
<p>Find the job ID</p>
</li>
<li>
<p>Now get the job details via the API interface:</p>
<ul>
<li>
<p>Login to the API with user <code>admin</code> and password <code>VERY_SECRET_PASSWORD</code>: <code>https://autoctl1.&lt;GUID&gt;.&lt;SANDBOXID&gt;.opentlc.com/api/</code></p>
</li>
<li>
<p>Open the URL <code>https://autoctl1.&lt;GUID&gt;.&lt;SANDBOXID&gt;.opentlc.com/api/v2/jobs/&lt;ID&gt;/</code> where <code>&lt;ID&gt;</code> is the number of the job you just looked up in the UI.</p>
</li>
<li>
<p>Search the page for the string you are interested in, e.g. <code>execution_node</code></p>
</li>
</ul>
</li>
</ul>

<div class="notices tip" ><p>You can of course query any controller node.</p>
</div>

<h2 id="ansible-execution-environments-primer">Ansible Execution Environments Primer!</h2>
<p>Now that you have investigated how jobs are run in an automation controller cluster it&rsquo;s about time to learn about one of the major new features in Ansible Automation Platform 2: <strong>Execution Environments</strong>!</p>
<p>Before AAP 2 the Automation Platform execution relied on using <strong>bubblewrap</strong> to isolate processes and Python virtual environments (venv) to sandbox dependencies. This lead to a number of issues like maintaining multiple venv, migrating Ansible content between execution nodes and much more. The concept of execution environments (EE) solves this by using Linux containers.</p>
<p>An EE is a container run from an image that contains everything your Ansible Playbook needs to run. It&rsquo;s basically a control node in a box that can be executed everywhere a Linux container can run. There are ready-made images that contain everything you would expect on an Ansible control node, but you can (and probably will) start to build your own, custom image for your very own requirements at some point.</p>
<p>Your automation controller has been preconfigured with some standard EE images. So first go through the next section covering ad hoc commands, we&rsquo;ll look a bit deeper into execution environments later.</p>

<div class="notices tip" ><p>Linux containers are technologies that allow you to package and isolate applications with their entire runtime environment. This makes it easy to move the contained application between environments and nodes while retaining full functionality.
In this lab you&rsquo;ll use the command <code>podman</code> later on. Podman is a daemon-less container engine for developing, managing, and running Open Container Initiative (OCI) containers and container images on your Linux System. If you want to learn more, there is a wealth of information on the Internet, you could start <a href="http://docs.podman.io/en/latest/Introduction.html">here</a> for Podman or <a href="https://www.ansible.com/blog/introduction-to-ansible-builder">here</a> for execution environments.</p>
</div>

<h2 id="execution-environments-a-deeper-look">Execution Environments: A deeper look</h2>
<p>As promised let&rsquo;s look a bit deeper into execution environments. In your automation controller web UI, go to <strong>Administration ⇒ Execution Environments</strong>. You&rsquo;ll see a list of the configured execution environments and original location of the image, in our case the images are provided in the <strong>registry.redhat.io</strong> container registry. Here you could add your own registry with custom EE images, too.</p>
<p>So what happens, when automation controller runs an ad hoc command or Playbook? Let&rsquo;s see&hellip;</p>
<p>You should already have your <strong>VS Code</strong> terminal open in another browser tab, if not open https://bastion.&lt;GUID&gt;.&lt;SANDBOXID&gt;.opentlc.com and do <strong>Terminal ⇒ New Terminal</strong>. In this terminal:</p>
<ul>
<li>
<p>SSH into your automation controller node (obviously replace &lt;GUID&gt; by your value):</p>
<ul>
<li><code>ssh autoctl1.&lt;GUID&gt;.internal</code></li>
</ul>
</li>
<li>
<p>You should be the <strong>ec2-user</strong> user on your automation controller now, become the <strong>awx</strong> user by running <code>sudo -u awx -i</code></p>
</li>
<li>
<p>First let&rsquo;s look for the image, you should have used the <strong>Default execution environment</strong> in your Playbook run which should result in this image (details might be different):</p>
</li>
</ul>
<pre><code>[awx@autoctl1 ~]$ podman images
REPOSITORY                                                                         TAG     IMAGE ID      CREATED      SIZE
registry.redhat.io/ansible-automation-platform-20-early-access/ee-supported-rhel8  2.0.0   85ca2003a842  5 weeks ago  920 MB
</code></pre><ul>
<li>
<p>It was pulled from the registry to be available locally.</p>
</li>
<li>
<p>Now we want to observe how an EE is run as a container when you execute your automation. <code>podman ps -w 2</code> will list running containers, the <code>-w</code> option updates the output regularly. Run the command, at first it will show you something like this (no container running):</p>
</li>
</ul>
<pre><code>CONTAINER ID  IMAGE   COMMAND  CREATED  STATUS  PORTS   NAMES
</code></pre><ul>
<li>
<p>Keep podman running, now it&rsquo;s time to execute some automation. Which should take some time so you can observe what&rsquo;s happening.</p>
</li>
<li>
<p>In the web UI run an ad hoc command. Go to <strong>Resources ⇒ Inventories ⇒ AWX Inventory</strong></p>
</li>
<li>
<p>In the <strong>Hosts</strong> view select the three hosts.</p>
</li>
<li>
<p>Click <strong>Run Command</strong>. Specify the ad hoc command:</p>
<ul>
<li>
<p><strong>Module</strong>: command</p>
</li>
<li>
<p><strong>Arguments</strong>: sleep 60</p>
</li>
<li>
<p><strong>Next</strong></p>
</li>
<li>
<p><strong>Execution Environment</strong>: Don&rsquo;t specify an EE, the <strong>Default execution environment</strong> will be used.</p>
</li>
<li>
<p><strong>Next</strong></p>
</li>
<li>
<p><strong>Machine Credential</strong>: AWX Credentials</p>
</li>
<li>
<p>Click <strong>Launch</strong></p>
</li>
</ul>
</li>
</ul>
<p>Now go back to the <strong>VS Code</strong> terminal. You&rsquo;ll see a container is launched to run the ad hoc command and then removed again:</p>
<pre><code>CONTAINER ID  IMAGE                         COMMAND               CREATED       STATUS            PORTS   NAMES
c8e9a13ab475  quay.io/ansible/awx-ee:0.2.0  ssh-agent sh -c t...  1 second ago  Up 2 seconds ago          ansible_runner_18
</code></pre>
<div class="notices tip" ><p>The <code>sleep 60</code> command was only used to keep the container running for some time. Your output will differ slightly.</p>
</div>

<ul>
<li>
<p>Feel free to relaunch the job again!</p>
</li>
<li>
<p>Stop <code>podman</code> with <code>CTRL-C</code>.</p>
</li>
<li>
<p>Logout of automation controller (twice <code>exit</code> or <code>CTRL-D</code>)</p>
</li>
</ul>
<p>This is how automation controller uses Linux containers to run Ansible automation jobs in their own dedicated environments.</p>





<footer class=" footline" >
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="https://ansible-labs-crew.github.io/ansible-controller-advanced/3-awx-collection-intro/" title="There is more to automation controller than the Web UI"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="https://ansible-labs-crew.github.io/ansible-controller-advanced/5-instance-groups/" title="automation controller instance groups" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="https://ansible-labs-crew.github.io/js/clipboard.min.js?1632505063"></script>
    <script src="https://ansible-labs-crew.github.io/js/perfect-scrollbar.min.js?1632505063"></script>
    <script src="https://ansible-labs-crew.github.io/js/perfect-scrollbar.jquery.min.js?1632505063"></script>
    <script src="https://ansible-labs-crew.github.io/js/jquery.sticky.js?1632505063"></script>
    <script src="https://ansible-labs-crew.github.io/js/featherlight.min.js?1632505063"></script>
    <script src="https://ansible-labs-crew.github.io/js/highlight.pack.js?1632505063"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="https://ansible-labs-crew.github.io/js/modernizr.custom-3.6.0.js?1632505063"></script>
    <script src="https://ansible-labs-crew.github.io/js/learn.js?1632505063"></script>
    <script src="https://ansible-labs-crew.github.io/js/hugo-learn.js?1632505063"></script>
    
        
            <script src="https://ansible-labs-crew.github.io/mermaid/mermaid.js?1632505063"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>
